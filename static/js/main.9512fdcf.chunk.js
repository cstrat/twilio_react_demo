(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,n,t){e.exports=t(235)},233:function(e,n,t){},235:function(e,n,t){"use strict";t.r(n);var a=t(0),l=t.n(a),c=t(5),o=t.n(c),r=t(12),i=t(239);function u(e){var n=e.feed;return l.a.createElement("ul",{id:"activityLog"},n.map(function(e,n){return l.a.createElement("li",{key:n},e)}))}var s=t(238),m=t(81),d=t(50),f=t(80),E=t(34);function g(e){var n=Object(a.useState)(null),t=Object(r.a)(n,2),c=t[0],o=t[1],i=Object(a.useState)(!1),u=Object(r.a)(i,2),g=u[0],C=u[1],h=Object(a.useState)(null),O=Object(r.a)(h,2),v=O[0],b=O[1],p=e.connected,N=e.device,j=e.log;return Object(a.useEffect)(function(){fetch("https://red-goat-4208.twil.io/capability-token").then(function(e){return e.json()}).then(function(e){e.token?(j("\ud83d\udd11 Auth Token Recieved!"),C(!1),o(e.token)):b("Error Fetching Token!")})},[]),l.a.createElement(l.a.Fragment,null,l.a.createElement(s.a,{isOpen:v,onClose:function(){b(null)}},v),l.a.createElement(m.a,{isOpen:!p,title:"Twilio Agent Demo"},l.a.createElement("div",{className:d.a.DIALOG_BODY},l.a.createElement("p",null,l.a.createElement("strong",null,"Before you can recieve calls this client will need to be authorised, fetching your token now..."))),l.a.createElement("div",{className:d.a.DIALOG_FOOTER},l.a.createElement("div",{className:d.a.DIALOG_FOOTER_ACTIONS},l.a.createElement(f.a,{intent:c?E.a.SUCCESS:E.a.NONE,loading:g,icon:c?"endorsed":"offline",disabled:!c,onClick:function(){N.setup(c)}},"Ready Up")))))}var C=t(14),h=t(118),O=t(236),v=t(119),b=t(124),p=t(6);function N(e){var n=Object(a.useState)(!1),t=Object(r.a)(n,2),c=t[0],o=t[1],i=e.connected,u=e.log,s=e.callState,m=e.setCallState,f=e.setRefresh,E=s.ringing,g=s.onCall,N=s.callerID,j=s.connection;return l.a.createElement("div",{id:"menu"},l.a.createElement("strong",null,"Twilio Agent Demo"),l.a.createElement("br",null),l.a.createElement("em",null,l.a.createElement(C.a,{className:i?d.a.INTENT_SUCCESS:d.a.INTENT_DANGER,icon:i?"confirm":"offline"})," ",i?"Online!":"Offline"),l.a.createElement(h.a,{id:"actionMenu",className:d.a.ELEVATION_1},E||g?l.a.createElement(O.a,{className:g?d.a.INTENT_WARNING:d.a.INTENT_SUCCESS,icon:"phone",text:g?"End Call":"Answer Call",onClick:function(){g?(j.disconnect(),m({ringing:!1,onCall:!1,callerID:null,connection:null})):j.accept()}}):l.a.createElement(v.a,{title:"No Active Calls"}),E&&l.a.createElement(O.a,{className:d.a.INTENT_DANGER,icon:"phone",text:"Reject Call",onClick:function(){u("\u274c Call Rejected."),f(Math.random()),j.reject(),m({ringing:!1,onCall:!1,callerID:null,connection:null})}}),N&&l.a.createElement(l.a.Fragment,null,l.a.createElement(v.a,null),l.a.createElement(b.a,{content:"Click here to ".concat(c?"unmute":"mute"," call."),position:p.a.BOTTOM},l.a.createElement(O.a,{className:c&&d.a.INTENT_WARNING,text:N,icon:c?"volume-off":"volume-up",onClick:function(){if(s.onCall){var e=j.isMuted();o(!e),j.mute(!e)}}})))))}var j=t(98);function S(e){var n=Object(a.useState)([]),t=Object(r.a)(n,2),c=t[0],o=t[1];return Object(a.useEffect)(function(){fetch("https://twilio-0f8a.restdb.io/rest/call-log",{mode:"cors",cache:"no-cache","content-type":"application/json",headers:{"x-apikey":"5c1c28e8056bf32b82ec4acf"}}).then(function(e){return e.json()}).then(function(e){o(e.reverse())}).catch(function(e){console.log(e)})},[e.refreshToken]),l.a.createElement("ul",{id:"callLog"},l.a.createElement("li",null,l.a.createElement("b",null,"Call Log")),c.map(function(e,n){return l.a.createElement("li",{key:n,className:"completed"!==e.status?"error":"completed"},Object(j.format)(e.date,"YY/MM/DD - HH:mm A"),": ",e.callerID," - ",e.status)}))}t(227),t(229),t(231),t(233);i.a.onlyShowFocusOnTabs();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(function(){var e=Object(a.useState)(!1),n=Object(r.a)(e,2),t=n[0],c=n[1],o=Object(a.useState)([]),i=Object(r.a)(o,2),s=i[0],m=i[1],d=Object(a.useState)([]),f=Object(r.a)(d,2),E=f[0],C=f[1],h=Object(a.useState)({ringing:!1,onCall:!1,callerID:null,connection:null}),O=Object(r.a)(h,2),v=O[0],b=O[1];function p(e){s.push(e),m(s)}var j=new Twilio.Device;return function(e){var n=e.device,t=e.setConnected,a=e.log,l=e.setRefresh,c=e.setCallState;n.on("ready",function(){t(!0),a("\ud83d\udc4d Client Ready.")}),n.on("incoming",function(e){a("\ud83d\udcde Incoming Call: ".concat(e.parameters.From)),c({ringing:!0,onCall:!1,callerID:e.parameters.From,connection:e})}),n.on("connect",function(e){a("\ud83d\udcde Call Established."),c({ringing:!1,onCall:!0,callerID:e.parameters.From,connection:e})}),n.on("disconnect",function(e){a("\u274c Call Disconnected."),l(Math.random()),c({ringing:!1,onCall:!1,callerID:null,connection:null})}),n.on("cancel",function(e){a("\u274c Caller Hung Up."),l(Math.random()),c({ringing:!1,onCall:!1,callerID:null,connection:null})})}({device:j,setConnected:c,log:p,callState:v,setCallState:b,setRefresh:C}),l.a.createElement(l.a.Fragment,null,l.a.createElement(g,{connected:t,setConnected:c,device:j,log:p}),l.a.createElement("div",{id:"frame"},l.a.createElement(N,{connected:t,device:j,log:p,callState:v,setCallState:b,setRefresh:C}),l.a.createElement(u,{feed:s}),t&&l.a.createElement(S,{refreshToken:E})))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[103,2,1]]]);
//# sourceMappingURL=main.9512fdcf.chunk.js.map